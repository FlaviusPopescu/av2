




NORMALIZED_RGB returns an image which should be 
lightness invariant.





\begin{Verbatim}[commandchars=\\\{\}]\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{function}\PY{+w}{ }[outimage] \PY{p}{=}\PY{+w}{ }\PY{n+nf}{normalized\PYZus{}rgb}\PY{p}{(}image\PY{p}{)}

\end{Verbatim}







Select the individual channels





\begin{Verbatim}[commandchars=\\\{\}]    \PY{n}{red} \PY{p}{=} \PY{n}{double}\PY{p}{(}\PY{n}{image}\PY{p}{(}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{p}{,} 1\PY{p}{)}\PY{p}{)}\PY{p}{;}
    \PY{n}{green} \PY{p}{=} \PY{n}{double}\PY{p}{(}\PY{n}{image}\PY{p}{(}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{p}{,} 2\PY{p}{)}\PY{p}{)}\PY{p}{;}
    \PY{n}{blue} \PY{p}{=} \PY{n}{double}\PY{p}{(}\PY{n}{image}\PY{p}{(}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{p}{,} 3\PY{p}{)}\PY{p}{)}\PY{p}{;}

    \PY{n}{sumsquares} \PY{p}{=} \PY{n+nb}{sqrt}\PY{p}{(}\PY{n}{red}\PY{o}{.\PYZca{}}2 \PY{o}{+} \PY{n}{green}\PY{o}{.\PYZca{}}2 \PY{o}{+} \PY{n}{blue}\PY{o}{.\PYZca{}}2\PY{p}{)}\PY{p}{;}
    
    \PY{n}{sum} \PY{p}{=} \PY{n}{red} \PY{o}{+} \PY{n}{green} \PY{o}{+} \PY{n}{blue}\PY{p}{;}


\end{Verbatim}







Make a matrix of the original dimensions and
fill it.





\begin{Verbatim}[commandchars=\\\{\}]   \PY{n}{outimage} \PY{p}{=} \PY{n+nb}{zeros}\PY{p}{(}\PY{n+nb}{size}\PY{p}{(}\PY{n}{image}\PY{p}{)}\PY{p}{)}\PY{p}{;}
   \PY{n}{outimage}\PY{p}{(}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{p}{,} 1\PY{p}{)} \PY{p}{=} \PY{n}{red} \PY{o}{./} \PY{n}{sumsquares}\PY{p}{;}
   \PY{n}{outimage}\PY{p}{(}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{p}{,} 2\PY{p}{)} \PY{p}{=} \PY{n}{green} \PY{o}{./} \PY{n}{sumsquares}\PY{p}{;}

\end{Verbatim}







  outimage(:, :, 3) = blue ./ sumsquares;





\begin{Verbatim}[commandchars=\\\{\}]   \PY{n}{outimage}\PY{p}{(}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{p}{,} 3\PY{p}{)} \PY{p}{=} 0\PY{p}{;}
   

\end{Verbatim}







outimage = zeros(size(image));
outimage(:, :, 1) = red ./ sum;
outimage(:, :, 2) = green ./ sum;
outimage(:, :, 3) = blue ./ sum;





\begin{Verbatim}[commandchars=\\\{\}]

\PY{k}{end}

\end{Verbatim}




